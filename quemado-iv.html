<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Paciente Quemado ‚Äì Sueros IV</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  background:#f2f2f2;
  margin:0;
  padding:20px;
  text-align:center;
}

.container {
  max-width:420px;
  margin:0 auto;
  background:#ffffff;
  padding:20px;
  border-radius:12px;
  box-shadow:0 4px 8px rgba(0,0,0,0.1);
  text-align:left;
}

h1 {
  font-size:22px;
  margin-bottom:8px;
  text-align:center;
}

p {
  text-align:center;
  color:#555;
  font-size:14px;
  margin-bottom:16px;
}

.menu-btn {
  width:100%;
  padding:16px;
  margin:12px 0;
  font-size:17px;
  border-radius:14px;
  border:none;
  background:#ffffff;
  box-shadow:0 3px 6px rgba(0,0,0,0.15);
  cursor:pointer;
}

.menu-btn:active {
  transform:translateY(2px);
}

.warn-btn {
  background:#fff3cd;
  color:#856404;
  font-weight:bold;
}

.back-btn {
  width:100%;
  margin-top:20px;
  padding:12px;
  font-size:16px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  background:#1976d2;
  color:white;
}

/* Popup */
.popup {
  display:none;
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.5);
  align-items:center;
  justify-content:center;
}

.popup-content {
  background:white;
  max-width:420px;
  width:90%;
  padding:20px;
  border-radius:12px;
  text-align:left;
}

.close-btn {
  margin-top:15px;
  width:100%;
  padding:10px;
  border:none;
  border-radius:8px;
  background:#1976d2;
  color:white;
  cursor:pointer;
}

/* Resultado %SCQ */
.scq-result {
  text-align:center;
  font-size:16px;
  color:#111;
  margin-top:12px;
  padding:10px;
  background:#f5f5f5;
  border-radius:10px;
}
.scq-hint {
  text-align:center;
  color:#555;
  font-size:13px;
  margin-top:8px;
}

/* Mensaje decisi√≥n */
.decision-box {
  text-align:center;
  margin-top:12px;
  padding:12px;
  border-radius:10px;
  background:#eef2ff;
}
.decision-msg {
  font-weight:bold;
  color:#111;
  margin-bottom:10px;
}
.decision-note {
  font-size:12px;
  color:#555;
  margin-top:8px;
  line-height:1.3;
  text-align:center;
}
</style>
</head>

<body>
<div class="container">
  <h1>üî• Paciente Quemado</h1>
  <p>Evaluaci√≥n inicial y manejo con l√≠quidos IV</p>

  <button class="menu-btn warn-btn" onclick="openPopup('advertencias')">‚ö†Ô∏è ADVERTENCIAS IMPORTANTES</button>

  <button class="menu-btn" onclick="openPopup('scq')">üßÆ Superficie corporal quemada</button>

  <!-- ‚úÖ Mantiene est√©tica y manda a parkland.html -->
  <button class="menu-btn" id="parklandBtn" onclick="goToParkland()">üíß Calculadora de l√≠quidos (Parkland)</button>

  <button class="menu-btn" onclick="location.href='manejo-quemaduras.html'">ü©π Manejo de quemaduras</button>

  <button class="back-btn" onclick="history.back()">‚¨Ö Volver</button>
</div>

<!-- Advertencias -->
<div class="popup" id="advertencias">
  <div class="popup-content">
    <h3>‚ö†Ô∏è Advertencias</h3>
    <ul>
      <li>No retirar ropa adherida a la piel</li>
      <li>No aplicar pomadas, aceites ni remedios caseros</li>
      <li>Enfriar con agua limpia solo los primeros minutos</li>
      <li>Buscar acceso venoso temprano</li>
      <li>Si no hay vena disponible, trasladar de inmediato</li>
    </ul>
    <button class="close-btn" onclick="closePopup('advertencias')">Cerrar</button>
  </div>
</div>

<!-- Superficie corporal quemada -->
<div class="popup" id="scq">
  <div class="popup-content">
    <h3>üßÆ Superficie corporal quemada</h3>
    <p>Selecciona las zonas afectadas (Regla del 9)</p>

    <!-- checkboxes con porcentaje -->
    <label><input type="checkbox" class="scq-zone" data-pct="9"> Cabeza (9%)</label><br>
    <label><input type="checkbox" class="scq-zone" data-pct="9"> Brazo derecho (9%)</label><br>
    <label><input type="checkbox" class="scq-zone" data-pct="9"> Brazo izquierdo (9%)</label><br>
    <label><input type="checkbox" class="scq-zone" data-pct="18"> Tronco anterior (18%)</label><br>
    <label><input type="checkbox" class="scq-zone" data-pct="18"> Tronco posterior (18%)</label><br>
    <label><input type="checkbox" class="scq-zone" data-pct="9"> Pierna derecha anterior (9%)</label><br>
    <label><input type="checkbox" class="scq-zone" data-pct="9"> Pierna derecha posterior (9%)</label><br>
    <label><input type="checkbox" class="scq-zone" data-pct="9"> Pierna izquierda anterior (9%)</label><br>
    <label><input type="checkbox" class="scq-zone" data-pct="9"> Pierna izquierda posterior (9%)</label><br>

    <p><strong>Grado de profundidad:</strong></p>
    <select id="burnDepth" style="width:100%; padding:8px;">
      <option>Primer grado</option>
      <option>Segundo grado</option>
      <option>Tercer grado</option>
    </select>

    <div class="scq-result">
      %SCQ total: <strong><span id="scqTotal">0</span>%</strong>
    </div>

    <!-- ‚úÖ Decisi√≥n autom√°tica + bot√≥n de acci√≥n -->
    <div class="decision-box">
      <div class="decision-msg" id="scqDecisionMsg">Selecciona zonas y profundidad.</div>
      <button class="close-btn" id="scqDecisionBtn" onclick="decisionAction()">Continuar</button>
      <div class="decision-note" id="scqDecisionNote">
        Regla r√°pida para adultos. Si es ni√±o/anciano o hay sospecha de inhalaci√≥n, considerar manejo m√°s agresivo y traslado.
      </div>
    </div>

    <button class="close-btn" onclick="closePopup('scq')">Cerrar</button>
  </div>
</div>

<script>
function openPopup(id) {
  document.getElementById(id).style.display = 'flex';
}

function closePopup(id) {
  document.getElementById(id).style.display = 'none';
}

/* %SCQ */
let currentSCQ = 0;

// destino del bot√≥n autom√°tico
let decisionTarget = 'manejo-quemaduras.html';

// ‚úÖ Umbral internacional t√≠pico para ADULTOS: ‚â•20% (2¬∫/3¬∫) ‚Üí IV formal
const IV_THRESHOLD_ADULT = 20;

function calculateSCQ() {
  let sum = 0;
  document.querySelectorAll('.scq-zone:checked').forEach(cb => {
    sum += parseFloat(cb.dataset.pct) || 0;
  });

  if (sum < 0) sum = 0;
  if (sum > 100) sum = 100;

  currentSCQ = sum;
  const out = document.getElementById('scqTotal');
  if (out) out.textContent = String(sum);

  try { localStorage.setItem('scq_total', String(sum)); } catch(e) {}

  updateDecision();
}

function updateDecision() {
  const depthEl = document.getElementById('burnDepth');
  const depth = depthEl ? depthEl.value : 'Primer grado';

  const msgEl = document.getElementById('scqDecisionMsg');
  const btnEl = document.getElementById('scqDecisionBtn');
  const noteEl = document.getElementById('scqDecisionNote');

  if (!msgEl || !btnEl) return;

  const isSuperficial = (depth === 'Primer grado');

  // regla binaria pedida:
  // - si ‚â•20% y no superficial ‚Üí Parkland
  // - si <20% o superficial ‚Üí Manejo de quemaduras
  if (currentSCQ >= IV_THRESHOLD_ADULT && !isSuperficial) {
    msgEl.textContent = '‚úÖ Requiere hidrataci√≥n IV';
    btnEl.textContent = 'Ir a Parkland';
    decisionTarget = 'parkland.html?scq=' + encodeURIComponent(currentSCQ || 0);
    if (noteEl) {
      noteEl.textContent = 'Criterio adulto: ‚â•20% (2¬∫/3¬∫). Si es ni√±o (‚â•10‚Äì15%), anciano, deshidratado o con inhalaci√≥n, considerar IV y traslado aunque sea menor.';
    }
  } else {
    msgEl.textContent = '‚úÖ Manejo local / seguimiento';
    btnEl.textContent = 'Ir a Manejo de quemaduras';
    decisionTarget = 'manejo-quemaduras.html';
    if (noteEl) {
      noteEl.textContent = 'Si hay dolor intenso, ampollas extensas, cara/manos/pies/genitales, inhalaci√≥n, el√©ctrico/qu√≠mico o comorbilidades, prioriza traslado.';
    }
  }
}

function decisionAction() {
  location.href = decisionTarget;
}

/* listeners */
document.addEventListener('change', (e) => {
  if (e.target && e.target.classList.contains('scq-zone')) {
    calculateSCQ();
  }
  if (e.target && e.target.id === 'burnDepth') {
    updateDecision();
  }
});

/* Bot√≥n Parkland principal (fuera del popup) */
function goToParkland() {
  let scq = currentSCQ;
  if (!scq) {
    try {
      const saved = parseFloat(localStorage.getItem('scq_total'));
      if (!isNaN(saved)) scq = saved;
    } catch(e) {}
  }
  location.href = 'parkland.html?scq=' + encodeURIComponent(scq || 0);
}

/* init */
(function initSCQ() {
  try {
    const saved = parseFloat(localStorage.getItem('scq_total'));
    if (!isNaN(saved)) {
      currentSCQ = saved;
      const out = document.getElementById('scqTotal');
      if (out) out.textContent = String(saved);
    }
  } catch(e) {}

  updateDecision();
})();
</script>
</body>
</html>
